<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>reader</title>
</head>
<body>
    <style>
        :root {
            --studio-blue: #0675c4;
        }
        .container {
            display: flex;
            justify-content: center;
        }
        pre {
            width: 512px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        pre > .name-link {
            color: var(--studio-blue);
            cursor: pointer;
            position: relative;
        }
        pre > .name-link::before {
            display: none;
            position: absolute;
            content: attr(data-info);
            color: white;
            background-color: rgba(0, 0, 0, .75);
        }
        pre > .name-link:hover::before {
            display: block;
        }
    </style>
    <div class="container">
        <pre></pre>
    </div>
    <script src="../js/vendor/param.js"></script>
    <script src="../js/vendor/names.js"></script>
    <script>
        var src = getParameter("src");
        if (src != undefined) {
            (function (url, callback) {
                const req = new XMLHttpRequest();
                req.addEventListener("load", () => {
                    if (callback && typeof callback === "function") {
                        callback(req.responseText);
                    } else {
                        console.log("loadData: no callback");
                    }
                });
                req.open("GET", url);
                req.send();
            })(src, function(responseText) {
                console.log("responseText: ", responseText);

                responseText = responseText.replaceAll("<", "&lt;");

                if (window.names != undefined) {
                    window.names = window.names.sort((a, b) => {
                        return b.split(";")[0].length - a.split(";")[0].length;
                    });
                    for (const line of window.names) {
                        const name = line.split(";")[0];
                        const info = line.split(";")[1];
                        responseText = responseText.replaceAll(name, "<span class='name-link' data-info='" + info + "'>" + name + "</span>");
                    }
                }

                const pre = document.getElementsByClassName("container")[0].getElementsByTagName("pre")[0];
                pre.innerHTML = responseText;
            });
        }
    </script>
</body>
</html>