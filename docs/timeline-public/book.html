<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>book</title>
    <link rel="stylesheet" href="css/book.css">
    <link rel="stylesheet" href="css/navbar.css">
    <script src="../js/timeline/navbar.js"></script>
</head>

<body>
    <style id="online">
        .index-wrapper>.item>.cover::before {
            background-color: rgba(6, 84, 3, .75);
        }
    </style>
    <div class="container-fluid">
        <div class="container">
            <div style="position: relative;">
                <a href="index.html" style="position: absolute;">return</a>
                <div class="top-bar">
                    <a id="raw-link"></a>
                </div>
            </div>
            <div class="index-wrapper" id="index-list"></div>
        </div>
    </div>

    <script src="../js/vendor/param.js"></script>
    <script src="../js/timeline/books-index.js"></script>
    <script>
        var bookNumber = getParameter("book");
        var rawLink = document.getElementById("raw-link");
        if (rawLink != undefined) {
            rawLink.href = "raw-" + bookNumber + ".html";
            const bookNames = [
                "",
                "黑書 1",
                "黑書 2",
                "散逸 1",
                "黑書 3",
                "棕書 1",
                "大棕書",
                "棕書 2",
                "棕書 3",
                "黑書 4",
                "黑書 5",
                "出路 1",
                "出路 2",
                "出路 3"
            ];
            rawLink.innerText = "pics of book " + bookNumber + "《" + bookNames[bookNumber] + "》";
        }
        var indexWrapper = document.getElementById("index-list");
        if (indexWrapper != undefined) {
            let list = books[bookNumber]["indexList"];
            let html = "";
            let counter = 1;
            for (let link of list) {
                let nameSplit = link.split("/");
                const filename = nameSplit.pop();
                const folder = nameSplit.pop();
                if (window.location.href.startsWith("file://")) {
                } else {
                    link = "book-reader.html?src=" + link;
                }
                html += "<a class=\"item\" id=\"item-" + counter++ + "\" href=\"" + link + "\">";
                html += "<div class=\"cover\" data-folder=\"" + folder + "\" data-filename=\"" + filename + "\"></div>";
                html += "<iframe src=\"" + link + "\" scrolling=\"no\"></iframe>";
                html += "</a>";
            }
            indexWrapper.innerHTML = html;

            if (window.location.href.startsWith("file://")) {
                let element = document.getElementById("online");
                element.parentElement.removeChild(element);
                let style = document.createElement("style");
                style.innerText = `
    .index-wrapper>.item>.cover::before {
        background-color: rgba(84, 6, 3, .75);
    }`;
                document.body.appendChild(style);
            }
        }
    </script>
</body>

</html>